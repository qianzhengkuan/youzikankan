(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/login"],{"1b83":function(e,t,n){"use strict";(function(e){n("ff80"),n("921b");i(n("66fd"));var t=i(n("3575"));function i(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("6e42")["createPage"])},3575:function(e,t,n){"use strict";n.r(t);var i=n("a315"),o=n("d738");for(var a in o)"default"!==a&&function(e){n.d(t,e,(function(){return o[e]}))}(a);n("efc6");var s,r=n("f0c5"),c=Object(r["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=c.exports},6395:function(e,t,n){"use strict";(function(e,n){var i;function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a={data:function(){return{auth_time:60,type:0,bottomText:["没有账号，去注册","已有账号，去登陆"],getCodeText:"获取验证码",getOver:!1,loginLoading:!1,registerLoading:!1,loginData:{account:"",l_password:""},registerData:{phone:"",code:"",r_password:""},providerList:[{providerName:"微信登录",icon:"../static/wxIcon.png",id:"weixin"}]}},methods:(i={closeLogin:function(){this.$commonJs.navBack()},navTo:function(e){this.$commonJs.navTo(e)},getCode:function(){var e=[{name:"phone",type:"required",errmsg:"请输入手机号"},{name:"phone",type:"phone",errmsg:"请输入正确的手机号"}],t=this.$validate.validate(this.registerData,e);if(!t.isOk)return this.$commonJs.uniMsg(t.errmsg),!1;this.getCode()}},o(i,"getCode",(function(){var e=this,t=this;this.$apiJs.getCode({phone:this.registerData.phone}).then((function(n){if(n){t.$commonJs.uniMsg("发送成功","success");var i=setInterval((function(){t.auth_time--,t.getCodeText=e.auth_time+"后获取",t.getOver=!0,t.auth_time<=0&&(t.getCodeText="获取验证码",t.getOver=!1,clearInterval(i))}),1e3)}}))})),o(i,"submitlogin",(function(){var e=[{name:"account",type:"required",errmsg:"请输入账号"},{name:"l_password",type:"required",errmsg:"请输入密码"}],t=this.$validate.validate(this.loginData,e);if(!t.isOk)return this.$commonJs.uniMsg(t.errmsg),!1;this.passowrdLogin()})),o(i,"passowrdLogin",(function(){var t=this;this.$apiJs.login({phone:this.loginData.account,password:this.loginData.l_password}).then((function(i){e("log",i," at pages\\login.vue:163"),i.accesstoken&&(n.setStorageSync("accesstoken",i.accesstoken),t.loginLoading=!0,t.registerLoading=!1)})).then((function(){t.getUserInfo()}))})),o(i,"submitRegister",(function(){var e=[{name:"phone",type:"required",errmsg:"请输入手机号"},{name:"phone",type:"phone",errmsg:"请输入正确的手机号"}],t=this.$validate.validate(this.registerData,e);if(!t.isOk)return this.$commonJs.uniMsg(t.errmsg),!1;this.phoneLogin()})),o(i,"phoneLogin",(function(){var t=this;this.$apiJs.phoneLogin({phone:this.registerData.phone,code:this.registerData.code}).then((function(i){e("log",i," at pages\\login.vue:208"),i.accesstoken&&(n.setStorageSync("accesstoken",i.accesstoken),t.registerLoading=!0,t.loginLoading=!1)})).then((function(){t.getUserInfo()}))})),o(i,"getUserInfo",(function(){var t=this;this.$apiJs.getUser({}).then((function(i){i&&(e("log",i," at pages\\login.vue:223"),n.setStorageSync("userInfo",i),t.$store.dispatch("setUserInfoObj",i))})).then((function(){setTimeout((function(){t.$commonJs.uniMsg("登录成功","success"),t.loginLoading=!1,n.switchTab({url:"index/index"}),e("log","跳转首页"," at pages\\login.vue:234")}),500)}))})),o(i,"getAuth",(function(){var t=this;n.getProvider({service:"oauth",success:function(n){e("log",JSON.stringify(n)," at pages\\login.vue:242"),t.providerList=n.provider.map((function(e){var t="",n="";switch(e){case"weixin":t="微信登录",n="../static/wxIcon.png";break;case"qq":t="QQ登录",n="../static/qqIcon.png";break;case"sinaweibo":t="新浪微博登录",n="../static/wbIcon.png";break;case"xiaomi":t="小米登录";break;case"alipay":t="支付宝登录";break;case"baidu":t="百度登录";break;case"toutiao":t="头条登录";break;case"apple":t="苹果登录";break}return{name:t,icon:n,id:e}}))},fail:function(t){e("log","获取登录通道失败",t," at pages\\login.vue:283")}})})),o(i,"authlogin",(function(t){var i=this;n.login({provider:t,success:function(o){e("log","login success:",o," at pages\\login.vue:291"),n.getUserInfo({provider:t,success:function(t){e("log","getUserInfo success",t," at pages\\login.vue:295"),i.hasUserInfo=!0,i.userInfo=t.userInfo},fail:function(t){e("log","getUserInfo fail",t," at pages\\login.vue:300");var i=t.errMsg;~i.indexOf("uni.login")&&(i="请在登录页面完成登录操作"),n.showModal({title:"获取用户信息失败",content:"错误原因"+i,showCancel:!1})}})},fail:function(t){e("log","login fail:",t," at pages\\login.vue:316")}})})),i),mounted:function(){this.getAuth()}};t.default=a}).call(this,n("0de9")["default"],n("6e42")["default"])},9672:function(e,t,n){},a315:function(e,t,n){"use strict";var i,o=function(){var e=this,t=e.$createElement;e._self._c;e._isMounted||(e.e0=function(t){e.type?e.type=0:e.type=1},e.e1=function(t){e.type?e.type=0:e.type=1})},a=[];n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i}))},d738:function(e,t,n){"use strict";n.r(t);var i=n("6395"),o=n.n(i);for(var a in i)"default"!==a&&function(e){n.d(t,e,(function(){return i[e]}))}(a);t["default"]=o.a},efc6:function(e,t,n){"use strict";var i=n("9672"),o=n.n(i);o.a}},[["1b83","common/runtime","common/vendor"]]]);