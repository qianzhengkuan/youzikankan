(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/news/newsInfo"],{"0846":function(n,e,t){"use strict";var i={"jyf-parser":function(){return Promise.all([t.e("common/vendor"),t.e("components/jyf-parser/jyf-parser")]).then(t.bind(null,"6fa9"))}},o=function(){var n=this,e=n.$createElement;n._self._c},s=[];t.d(e,"b",(function(){return o})),t.d(e,"c",(function(){return s})),t.d(e,"a",(function(){return i}))},"3b5d":function(n,e,t){"use strict";(function(n){t("ff80"),t("921b");i(t("66fd"));var e=i(t("ec31"));function i(n){return n&&n.__esModule?n:{default:n}}n(e.default)}).call(this,t("6e42")["createPage"])},"6fdb":function(n,e,t){"use strict";(function(n,i){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=r(t("1dd1"));a(t("4983"));function s(){if("function"!==typeof WeakMap)return null;var n=new WeakMap;return s=function(){return n},n}function a(n){if(n&&n.__esModule)return n;if(null===n||"object"!==typeof n&&"function"!==typeof n)return{default:n};var e=s();if(e&&e.has(n))return e.get(n);var t={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in n)if(Object.prototype.hasOwnProperty.call(n,o)){var a=i?Object.getOwnPropertyDescriptor(n,o):null;a&&(a.get||a.set)?Object.defineProperty(t,o,a):t[o]=n[o]}return t.default=n,e&&e.set(n,t),t}function r(n){return n&&n.__esModule?n:{default:n}}var u=function(){t.e("pages/template/pinglun").then(function(){return resolve(t("2622"))}.bind(null,t)).catch(t.oe)},c=function(){t.e("pages/template/pinglun-panel").then(function(){return resolve(t("814e"))}.bind(null,t)).catch(t.oe)},l=function(){Promise.all([t.e("common/vendor"),t.e("components/jyf-parser/jyf-parser")]).then(function(){return resolve(t("6fa9"))}.bind(null,t)).catch(t.oe)},f="/pages/news/newsInfo",h={components:{pinglun:u,pinglunPanel:c,jyfParser:l},data:function(){return{showPL:!0,guanFlag:!1,plList:[],info:"",noPingLun:!1,zanFlag:!1,shoucangFlag:!1,contentImageList:[],shareData:{appId:"wx1e1c7d0b7f8d179e",shareImg:"http://h5.youzikankan.com/logo.png"},shareFlag:!1,reloadFlag:!1,openAppShare:!1,seeImageFlag:!1,userLogin:!0}},onShow:function(){var n=this;this.shareFlag&&setTimeout((function(){n.shareFlag=!1}),500)},onNavigationBarButtonTap:function(n){n.index;this.openAppShare=!0},methods:{openDown:function(){this.$commonJs.uniMsg("未上线app应用")},openH5:function(){n.switchTab({url:"../index/index"})},onShare:function(n){var e=this;i("log",e.info," at pages\\news\\newsInfo.vue:168"),i("log",f," at pages\\news\\newsInfo.vue:169"),this.$commonJs.shareYzkkToWx({title:e.info.title,desc:e.info.desc,type:e.info.img.length?0:1,scene:n,link:this.$YZKK.wwwRoot+f+"?id="+e.id,shareImg:e.info.img.length?e.info.img[0].url:""}).then((function(n){e.shareFlag=!0}))},shareWx_h5_init:function(){var n=this,e=this;this.$apiJs.getSignPackage({url:location.href}).then((function(t){n.shareData.appId=t.appId,wxapi.wxRegister(t,{title:e.info.title,link:t.url,imgUrl:e.info.img.length?e.info.img[0].url:"",desc:e.info.desc,success:function(){e.shareFlag=!0},error:function(){i("log","分享error"," at pages\\news\\newsInfo.vue:198")}})})).then((function(){}))},getInfo:function(e){var t=this,i=this;this.$apiJs.getNewsInfo({id:e}).then((function(e){var s=e;s.time=i.$commonJs.timeFormat.noYearFormat(s.create_time);var a=s.content.content.replace(new RegExp("<video","gm"),'<video width="100%"').replace(new RegExp('style="',"gm"),'style="max-width:100% !important;width:100% !important;height:auto !important;').replace(new RegExp('text-indent:28pt;"><video',"gm"),'"><video').replace(new RegExp("<img","gm"),'<img width="100%"').replace(new RegExp('style="',"gm"),'style="max-width:100% !important;width:100% !important;height:auto !important;').replace(new RegExp('text-indent:2em;"><img',"gm"),'"><img');s.desc=s.content.content.replace(/<[^>]+>/g,"").replace(/&nbsp;/gi,""),s.content=(0,o.default)(a),i.info=s,i.setTitle("游子看看"),n.getStorageSync("accesstoken")&&t.getFollowCode()})).then((function(){})).then((function(){}))},showImage:function(e){var t=n.createSelectorQuery(".content").in(this);i("log",JSON.stringify(t.select("img"))," at pages\\news\\newsInfo.vue:256")},showErrorImage:function(n){n.target.dataset.index;this.info.user_img=this.$errorImage},shoucangNew:function(){var n=this,e=this;this.$commonJs.isLogin().then((function(t){n.$apiJs.setCollectionNews({news_id:e.id}).then((function(e){n.getCollectionNews()}))}))},getCollectionNews:function(){var n=this,e=this;return new Promise((function(t,i){n.$apiJs.getCollectionNews({id:e.id}).then((function(e){"seeOther"!=e?n.shoucangFlag=Number(e):n.userLogin=!1}))}))},huifu:function(n){this.userLogin?n.plNum?this.navTo("plInfo",n):(i("log","弹出评论面板"," at pages\\news\\newsInfo.vue:294"),this.otherUser=n.user_id,this.pl_id=n.id,this.$refs.plPanel.showPl()):this.$commonJs.toLoginPage()},openPl:function(){this.userLogin?this.$refs.plPanel.showPl():this.$commonJs.toLoginPage()},dianzanNew:function(){var n=this,e=this;this.$commonJs.isLogin().then((function(t){n.$apiJs.setFabulousNews({news_id:e.id}).then((function(e){n.getFabulousNewsCode()}))}))},getFabulousNewsCode:function(){var n=this,e=this;return new Promise((function(t,i){n.$apiJs.getFabulousNewsCode({id:e.id}).then((function(e){"seeOther"!=e&&(n.zanFlag=e)}))}))},setFollow:function(){var n=this,e=this;this.$commonJs.isLogin().then((function(t){n.$apiJs.setFollow({author_id:e.info.author_id}).then((function(e){n.getFollowCode()}))}))},getFollowCode:function(){var n=this,e=this;return new Promise((function(t,i){n.$apiJs.getFollowCode({id:e.info.author_id}).then((function(e){n.guanFlag=e}))}))},dianzan:function(n){var e=this,t=this,i=n.id;this.$commonJs.isLogin().then((function(o){e.$apiJs.setFabulousUser({news_id:t.id,to_user_id:n.user_id,comment_id:i}).then((function(n){e.getPingLun()}))}))},getFabulousUserCode:function(){var n=this,e=this;return new Promise((function(t,i){n.$apiJs.getFabulousUserCode({id:e.id}).then((function(e){n.zanFlag=e}))}))},submitPl:function(n){var e=this,t=this;this.otherUser?this.$apiJs.replyComment({news_id:t.id,content:n,author_id:this.otherUser,content_id:this.pl_id}).then((function(n){i("log",n," at pages\\news\\newsInfo.vue:392"),n&&(e.$commonJs.uniMsg("回复成功"),e.$refs.plPanel.closePl(),e.getPingLun())})):this.$apiJs.setComment({news_id:t.id,content:n,author_id:this.info.author_id}).then((function(n){i("log",n," at pages\\news\\newsInfo.vue:406"),n&&(e.$commonJs.uniMsg("评论成功"),e.$refs.plPanel.closePl(),e.getPingLun())}))},getPingLun:function(){var n=this,e=this;this.$apiJs.getLoginComment({id:e.id}).then((function(t){if("seeOther"!=t){var i=t;i.length?(t.map((function(n,t){n.time=e.$commonJs.timeFormat.noYearFormat(n.create_time)})),n.plList=t):n.noPingLun=!0}else n.$apiJs.getComment({id:e.id}).then((function(t){if(t.length){t.map((function(n,t){n.time=e.$commonJs.timeFormat.noYearFormat(n.create_time)})),n.plList=t}else n.noPingLun=!0}))}))},openPingLunInfo:function(e){n.navigateTo({url:"./plInfo?new_id="+this.id+"&author_id="+e.user_id+"&content_id="+e.id})},navTo:function(n,e){this.$commonJs.navTo(n+"?id="+e.name)},setTitle:function(e){n.setNavigationBarTitle({title:e})}},onLoad:function(n){this.id=n.id,this.getInfo(n.id),this.getPingLun(n.id),n.from||(this.getFabulousNewsCode(),this.getCollectionNews()),n.from&&(this.showPL=!1)}};e.default=h}).call(this,t("6e42")["default"],t("0de9")["default"])},9984:function(n,e,t){},"9b09":function(n,e,t){"use strict";var i=t("9984"),o=t.n(i);o.a},bc4f:function(n,e,t){"use strict";t.r(e);var i=t("6fdb"),o=t.n(i);for(var s in i)"default"!==s&&function(n){t.d(e,n,(function(){return i[n]}))}(s);e["default"]=o.a},ec31:function(n,e,t){"use strict";t.r(e);var i=t("0846"),o=t("bc4f");for(var s in o)"default"!==s&&function(n){t.d(e,n,(function(){return o[n]}))}(s);t("9b09");var a,r=t("f0c5"),u=Object(r["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],a);e["default"]=u.exports}},[["3b5d","common/runtime","common/vendor"]]]);