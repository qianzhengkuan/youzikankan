(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/package_other/login"],{"3b2a":function(e,n,t){"use strict";(function(e){var t;function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i={data:function(){return{auth_time:60,type:0,bottomText:["没有账号，去注册","已有账号，去登陆"],getCodeText:"获取验证码",getOver:!1,loginLoading:!1,registerLoading:!1,loginData:{account:"",l_password:""},registerData:{phone:"",code:"",r_password:""},providerList:[{providerName:"微信登录",icon:"../../static/wxIcon.png",id:"weixin"}]}},methods:(t={closeLogin:function(){this.$commonJs.navBack()},navTo:function(e){this.$commonJs.navTo(e)},getCode:function(){var e=[{name:"phone",type:"required",errmsg:"请输入手机号"},{name:"phone",type:"phone",errmsg:"请输入正确的手机号"}],n=this.$validate.validate(this.registerData,e);if(!n.isOk)return this.$commonJs.uniMsg(n.errmsg),!1;this.getCode()}},o(t,"getCode",(function(){var e=this,n=this;this.$apiJs.getCode({phone:this.registerData.phone}).then((function(t){if(t){n.$commonJs.uniMsg("发送成功","success");var o=setInterval((function(){n.auth_time--,n.getCodeText=e.auth_time+"后获取",n.getOver=!0,n.auth_time<=0&&(n.getCodeText="获取验证码",n.getOver=!1,clearInterval(o))}),1e3)}}))})),o(t,"submitlogin",(function(){var e=[{name:"account",type:"required",errmsg:"请输入账号"},{name:"l_password",type:"required",errmsg:"请输入密码"}],n=this.$validate.validate(this.loginData,e);if(!n.isOk)return this.$commonJs.uniMsg(n.errmsg),!1;this.passowrdLogin()})),o(t,"passowrdLogin",(function(){var n=this;this.$apiJs.login({phone:this.loginData.account,password:this.loginData.l_password}).then((function(t){console.log(t),t.accesstoken&&(e.setStorageSync("accesstoken",t.accesstoken),n.loginLoading=!0,n.registerLoading=!1)})).then((function(){n.getUserInfo()}))})),o(t,"submitRegister",(function(){var e=[{name:"phone",type:"required",errmsg:"请输入手机号"},{name:"phone",type:"phone",errmsg:"请输入正确的手机号"}],n=this.$validate.validate(this.registerData,e);if(!n.isOk)return this.$commonJs.uniMsg(n.errmsg),!1;this.phoneLogin()})),o(t,"phoneLogin",(function(){var n=this;this.$apiJs.phoneLogin({phone:this.registerData.phone,code:this.registerData.code}).then((function(t){console.log(t),t.accesstoken&&(e.setStorageSync("accesstoken",t.accesstoken),n.registerLoading=!0,n.loginLoading=!1)})).then((function(){n.getUserInfo()}))})),o(t,"getUserInfo",(function(){var n=this;this.$apiJs.getUser({}).then((function(t){t&&(console.log(t),e.setStorageSync("userInfo",t),n.$store.dispatch("setUserInfoObj",t))})).then((function(){setTimeout((function(){n.$commonJs.uniMsg("登录成功","success"),n.loginLoading=!1,e.switchTab({url:"/pages/tabbar/index"}),console.log("跳转首页")}),500)}))})),o(t,"getAuth",(function(){var n=this;e.getProvider({service:"oauth",success:function(e){console.log(JSON.stringify(e)),n.providerList=e.provider.map((function(e){var n="",t="";switch(e){case"weixin":n="微信登录",t="../../static/wxIcon.png";break;case"qq":n="QQ登录",t="../../static/qqIcon.png";break;case"sinaweibo":n="新浪微博登录",t="../../static/wbIcon.png";break;case"xiaomi":n="小米登录";break;case"alipay":n="支付宝登录";break;case"baidu":n="百度登录";break;case"toutiao":n="头条登录";break;case"apple":n="苹果登录";break}return{name:n,icon:t,id:e}}))},fail:function(e){console.log("获取登录通道失败",e)}})})),o(t,"authlogin",(function(n){var t=this;e.login({provider:n,success:function(o){console.log("login success:",o),e.getUserInfo({provider:n,success:function(n){console.log("getUserInfo success",n.userInfo),t.$apiJs.weixinLogin(n.userInfo).then((function(n){console.log(n),n.accesstoken&&e.setStorageSync("accesstoken",n.accesstoken)})).then((function(){t.getUserInfo()}))},fail:function(e){console.log("getUserInfo fail",e);var n=e.errMsg;~n.indexOf("uni.login")&&(n="请在登录页面完成登录操作")}})},fail:function(e){console.log("login fail:",e)}})})),t),mounted:function(){this.getAuth()}};n.default=i}).call(this,t("543d")["default"])},b840:function(e,n,t){"use strict";(function(e){t("c233"),t("921b");o(t("66fd"));var n=o(t("d886"));function o(e){return e&&e.__esModule?e:{default:e}}e(n.default)}).call(this,t("543d")["createPage"])},d649:function(e,n,t){},d886:function(e,n,t){"use strict";t.r(n);var o=t("e8dc"),i=t("e218");for(var s in i)"default"!==s&&function(e){t.d(n,e,(function(){return i[e]}))}(s);t("e279");var a,r=t("f0c5"),c=Object(r["a"])(i["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],a);n["default"]=c.exports},e218:function(e,n,t){"use strict";t.r(n);var o=t("3b2a"),i=t.n(o);for(var s in o)"default"!==s&&function(e){t.d(n,e,(function(){return o[e]}))}(s);n["default"]=i.a},e279:function(e,n,t){"use strict";var o=t("d649"),i=t.n(o);i.a},e8dc:function(e,n,t){"use strict";var o,i=function(){var e=this,n=e.$createElement;e._self._c;e._isMounted||(e.e0=function(n){e.type?e.type=0:e.type=1},e.e1=function(n){e.type?e.type=0:e.type=1})},s=[];t.d(n,"b",(function(){return i})),t.d(n,"c",(function(){return s})),t.d(n,"a",(function(){return o}))}},[["b840","common/runtime","common/vendor"]]]);